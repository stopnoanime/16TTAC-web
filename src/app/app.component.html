<div class="grid main-grid min-h-screen" style="background-color: #ebebeb">
  <app-control-menu
    class="sm:col-span-2"
    [wasCompiled]="wasCompiled"
    [running]="sim.running"
    (compile)="compile()"
    (reset)="sim.reset()"
    (singleStep)="sim.singleStep()"
    (startStop)="sim.startStop()"
    (fullSpeedChange)="sim.fullSpeed = $event"
    (timeoutChange)="sim.timeout = $event"
  ></app-control-menu>

  <app-code-editor
    class="sm:row-span-2 sm:col-span-2 lg:col-span-1"
    [disabled]="sim.running"
    [compiled]="wasCompiled"
    [parserOutput]="parserOutput"
    [(sourceCode)]="sourceCode"
    (sourceCodeChange)="wasCompiled = false"
    [highlightBlue]="sim.simProp.adr"
    [highlightGreen]="sim.simProp.pc"
    [highlightPurple]="memoryViewerHoveredAddress"
    (hoveredAddressChange)="sourceCodeHoveredAddress = $event"
    (breakpointsChange)="sim.breakpoints = $event"
  ></app-code-editor>

  <app-terminal
    class="sm:col-span-2 lg:row-start-4"
    [outputEvent]="sim.outputEvent"
    [clearEvent]="sim.clearEvent"
    (input)="sim.input = $event"
  ></app-terminal>

  <app-cpu-status class="p-2 lg:py-0" [simProp]="sim.simProp"></app-cpu-status>

  <div class="flex gap-2 p-2 flex-wrap justify-center">
    <app-memory-viewer
      [uint16Array]="sim.simProp.memory"
      [blockSize]="64"
      [highlightBlue]="sim.simProp.adr"
      [highlightGreen]="sim.simProp.pc"
      [highlightPurple]="sourceCodeHoveredAddress"
      (hoveredAddressChange)="memoryViewerHoveredAddress = $event"
    ></app-memory-viewer>

    <app-memory-viewer
      [uint16Array]="sim.simProp.stack"
      [blockSize]="16"
      [wordsPerRow]="1"
      [maxAddress]="256"
      [label]="'Stack viewer'"
      [highlightBlue]="sim.simProp.stackPointer"
    ></app-memory-viewer>
  </div>
</div>
